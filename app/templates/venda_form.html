<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Nova Venda | Gráfica Implotter</title>
  <style>
    body { font-family: Arial; margin: 0; background: #f4f4f4; }
    header { background: #2c3e50; color: white; padding: 20px; text-align: center; }
    nav { background: #34495e; padding: 10px; display: flex; gap: 20px; justify-content: center; }
    nav a { color: white; text-decoration: none; font-weight: bold; }
    nav a:hover { text-decoration: underline; }
    .conteudo { padding: 30px; }
    form { max-width: 700px; margin: auto; background: white; padding: 20px; border-radius: 5px; box-shadow: 0 0 10px #ccc; }
    label { display: block; margin-bottom: 5px; font-weight: bold; }
    select, input[type="number"] { width: 100%; padding: 8px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 4px; }
    button { background: #2980b9; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; }
    button:hover { background: #3498db; }
    .item-produto { display: flex; gap: 10px; align-items: center; margin-bottom: 15px; }
    .item-produto select, .item-produto input { flex: 1; }
    .remove-btn { background: #e74c3c; padding: 6px 12px; border-radius: 4px; cursor: pointer; color: white; font-size: 12px; }
    .remove-btn:hover { background: #c0392b; }
  </style>
</head>
<body>
  <header>
    <h1>Nova Venda</h1>
  </header>
  <nav>
    <a href="/painel">🏠 Início</a>
    <a href="/cadastros">🧾 Cadastros</a>
    <a href="/clientes">👥 Clientes</a>
    <a href="/produtos">📦 Produtos</a>
    <a href="/vendas">💰 Vendas</a>
    <a href="/logout">🔓 Sair</a>
  </nav>
  <div class="conteudo">
    <form method="post" action="/vendas/nova">
      <label for="cliente">Cliente:</label>
      <select name="cliente_id" required>
        {% for cliente in clientes %}
        <option value="{{ cliente.id }}">{{ cliente.nome }}</option>
        {% endfor %}
      </select>

      <label for="forma_pagamento">Forma de Pagamento:</label>
      <select name="forma_pagamento" required>
        <option value="avista">À vista</option>
        <option value="prazo">A prazo</option>
      </select>

      <div id="produtos-container">
        <div class="item-produto">
          <select name="produto_id">
            {% for produto in produtos %}
            <option value="{{ produto.id }}">{{ produto.nome }} - R$ {{ '%.2f'|format(produto.preco_venda or 0) }}</option>
            {% endfor %}
          </select>
          <input type="number" name="quantidade" min="0.1" value="1" step="any" placeholder="Quantidade">
          <span class="remove-btn" onclick="removerProduto(this)">🗑</span>
        </div>
      </div>

      <button type="button" onclick="adicionarProduto()">➕ Adicionar Produto</button>
      <br><br>
      <button type="submit">💾 Finalizar Venda</button>
    </form>
  </div>

  <script>
    function adicionarProduto() {
      const container = document.getElementById("produtos-container");
      const item = document.createElement("div");
      item.className = "item-produto";
      item.innerHTML = `
        <select name="produto_id">
          {% for produto in produtos %}
          <option value="{{ produto.id }}">{{ produto.nome }} - R$ {{ '%.2f'|format(produto.preco_venda or 0) }}</option>
          {% endfor %}
        </select>
        <input type="number" name="quantidade" min="0.1" value="1" step="any" placeholder="Quantidade">
        <span class="remove-btn" onclick="removerProduto(this)">🗑</span>
      `;
      container.appendChild(item);
    }

    function removerProduto(botao) {
      const item = botao.parentNode;
      item.remove();
    }
  </script>
</body>
</html>
